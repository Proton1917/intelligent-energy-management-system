# 智能能耗管理系统使用说明

## 目录

1. [系统概述](#系统概述)
2. [安装与配置](#安装与配置)
3. [界面介绍](#界面介绍)
4. [功能详解](#功能详解)
5. [数据管理](#数据管理)
6. [故障排除](#故障排除)
7. [最佳实践](#最佳实践)

## 系统概述

智能能耗管理系统是一个专业的能源管理工具，帮助用户实现对用电设备的全面监控和管理。系统提供两种操作界面：

- **图形界面版本**: 适合日常操作，界面友好，功能完整
- **命令行版本**: 适合服务器环境，操作高效，资源占用少

## 安装与配置

### 系统要求

**最低配置**:
- CPU: 1GHz 处理器
- 内存: 512MB RAM
- 存储: 100MB 可用空间
- Python: 3.11 或更高版本

**推荐配置**:
- CPU: 2GHz 双核处理器
- 内存: 2GB RAM
- 存储: 500MB 可用空间
- 显示器: 1024x768 分辨率

### 安装步骤

#### 1. 安装Python环境
```bash
# Windows
下载并安装Python 3.11+ from python.org

# Ubuntu/Debian
sudo apt update
sudo apt install python3 python3-pip python3-tk

# CentOS/RHEL
sudo yum install python3 python3-pip tkinter

# macOS
brew install python3 python-tk
```

#### 2. 安装依赖包
```bash
pip install matplotlib numpy
```

#### 3. 下载系统文件
```bash
# 解压系统文件到目标目录
unzip energy_management_system.zip
cd energy_management_system
```

#### 4. 验证安装
```bash
cd src
python comprehensive_test.py
```

### 配置说明

系统使用JSON文件存储配置和数据，主要配置文件：

- `data/energy_data.json`: 系统数据文件
- 首次运行时会自动创建默认配置

## 界面介绍

### 图形界面版本

#### 主界面
启动图形界面版本后，您将看到：

1. **标题栏**: 显示系统名称
2. **功能按钮区**: 六个主要功能模块按钮
3. **系统状态区**: 显示设备数量、告警数量等
4. **数据概览区**: 包含设备列表、告警信息和数据图表

#### 菜单栏
- **文件菜单**: 导入数据、导出数据、退出
- **工具菜单**: 系统设置、数据备份
- **帮助菜单**: 使用说明、关于

### 命令行版本

命令行界面采用菜单驱动方式：

1. **主菜单**: 显示所有功能选项
2. **子菜单**: 每个功能模块的详细操作
3. **状态显示**: 实时显示系统状态信息

## 功能详解

### 1. 设备管理

#### 设备注册
1. 点击"设备管理"按钮或选择菜单选项1
2. 在设备管理窗口中填写设备信息：
   - **设备名称**: 设备的识别名称（必填）
   - **设备类型**: HVAC、Lighting、Other等
   - **安装位置**: 设备安装的具体位置
   - **额定功率**: 设备的额定功率（瓦特）
   - **能效等级**: A++、A+、A、B、C
   - **制造商**: 设备制造商名称
   - **型号**: 设备型号

3. 点击"添加设备"完成注册

#### 设备管理操作
- **查看设备列表**: 显示所有已注册设备
- **设备详情**: 查看设备的详细信息
- **状态更新**: 修改设备运行状态
- **维护安排**: 制定设备维护计划

#### 维护计划
1. 选择需要维护的设备
2. 填写维护信息：
   - **维护类型**: preventive（预防性）、corrective（纠正性）、routine（例行）
   - **计划日期**: 维护执行日期
   - **维护描述**: 详细的维护内容
   - **技术员**: 负责维护的技术人员
   - **预估费用**: 维护成本预估

### 2. 用电监控

#### 数据记录
1. 选择要监控的设备
2. 输入用电参数：
   - **电压**: 设备工作电压（伏特）
   - **电流**: 设备工作电流（安培）
   - **功率**: 实际功率消耗（瓦特）
   - **温度**: 环境温度（摄氏度）
   - **湿度**: 环境湿度（百分比）

3. 点击"记录数据"保存

#### 历史数据查询
- 选择设备和时间范围
- 查看用电历史记录
- 分析用电趋势

#### 告警管理
系统自动检测以下异常情况：
- **电压异常**: 电压超出正常范围
- **过载告警**: 功率超出额定值
- **高能耗告警**: 能耗异常增高
- **温度告警**: 环境温度异常

### 3. 能耗分析

#### 基础分析
提供设备的基本能耗统计：
- **总能耗**: 指定时间段内的总用电量
- **平均功率**: 平均功率消耗
- **峰值功率**: 最大功率记录
- **最低功率**: 最小功率记录
- **运行效率**: 设备运行效率百分比

#### 峰谷分析
分析设备在不同时段的用电情况：
- **峰时用电**: 8:00-22:00的用电量
- **谷时用电**: 22:00-8:00的用电量
- **用电模式**: 分析用电时间分布

#### 能耗预测
基于历史数据预测未来能耗：
- **预测算法**: 使用线性回归和时间序列分析
- **预测精度**: 提供置信度评估
- **预测范围**: 支持1-168小时预测

#### 效率评级
对设备进行效率评级：
- **A++级**: 效率≥95%（优秀）
- **A+级**: 效率85-95%（良好）
- **A级**: 效率75-85%（一般）
- **B级**: 效率65-75%（较差）
- **C级**: 效率<65%（差）

### 4. 节能建议

#### 建议生成
系统基于设备运行数据自动生成节能建议：

**建议类型**:
- **运行时间优化**: 调整设备运行时间
- **维护检查**: 建议进行设备维护
- **设备升级**: 建议更换高效设备
- **参数调整**: 优化运行参数

**优先级分类**:
- **高优先级**: 立即执行，效果显著
- **中优先级**: 近期执行，效果良好
- **低优先级**: 长期规划，效果一般

#### 建议实施
1. 查看建议详情和预期效果
2. 评估实施成本和难度
3. 标记建议为"已实施"
4. 跟踪实施效果

#### 效果跟踪
- **基准对比**: 与实施前数据对比
- **节能量计算**: 计算实际节能效果
- **投资回报**: 评估经济效益

### 5. 成本计算

#### 电价设置
系统内置分时电价：
- **峰时电价**: 0.85元/kWh（8:00-22:00）
- **谷时电价**: 0.45元/kWh（22:00-8:00）

#### 日成本计算
计算指定日期的电费：
- **总电费**: 当日总电费支出
- **峰时电费**: 峰时段电费
- **谷时电费**: 谷时段电费
- **平均电价**: 加权平均电价

#### 月成本计算
计算月度电费统计：
- **月度总费用**: 整月电费支出
- **日均费用**: 平均每日电费
- **费用趋势**: 与上月对比分析

#### 预算管理
- **预算设置**: 设定月度电费预算
- **预算跟踪**: 实时监控预算执行
- **超预算告警**: 预算超支提醒

### 6. 报表生成

#### 日报表
生成指定日期的能耗报表：
- **总体概况**: 总用电量、总电费、设备数量
- **设备明细**: 各设备的详细用电情况
- **效率分析**: 设备运行效率统计
- **告警汇总**: 当日告警情况

#### 月报表
生成月度综合报表：
- **月度统计**: 月度用电量和费用
- **趋势分析**: 与历史月份对比
- **设备排名**: 按用电量排序
- **改进建议**: 基于数据的优化建议

#### 报表导出
- **文本格式**: 导出为TXT文件
- **打印功能**: 支持报表打印
- **历史报表**: 查看历史生成的报表

## 数据管理

### 数据备份
1. 进入"数据管理"菜单
2. 选择"数据备份"
3. 系统自动创建带时间戳的备份文件

### 数据导入导出
- **导入**: 从JSON文件导入数据
- **导出**: 将数据导出为JSON文件
- **格式**: 标准JSON格式，支持跨平台

### 数据清理
定期清理过期数据：
- **用电记录**: 清理30天前的详细记录
- **告警信息**: 清理已处理的告警
- **维护记录**: 清理已完成的维护记录

## 故障排除

### 常见问题

#### 1. 程序无法启动
**问题**: 双击程序无反应或报错
**解决方案**:
```bash
# 检查Python版本
python --version

# 检查依赖包
pip list | grep matplotlib
pip list | grep numpy

# 重新安装依赖
pip install --upgrade matplotlib numpy
```

#### 2. 图形界面无法显示
**问题**: 提示"no display name and no $DISPLAY environment variable"
**解决方案**:
```bash
# Linux系统安装tkinter
sudo apt-get install python3-tk

# 使用命令行版本
python cli_main.py
```

#### 3. 数据文件损坏
**问题**: 提示JSON格式错误
**解决方案**:
```bash
# 恢复备份文件
cp backup_YYYYMMDD_HHMMSS.json data/energy_data.json

# 或删除数据文件重新开始
rm data/energy_data.json
```

#### 4. 性能问题
**问题**: 系统运行缓慢
**解决方案**:
- 定期清理历史数据
- 检查系统资源使用情况
- 关闭不必要的后台程序

### 错误代码说明

- **E001**: 数据文件读取失败
- **E002**: 设备ID不存在
- **E003**: 数据格式错误
- **E004**: 权限不足
- **E005**: 磁盘空间不足

## 最佳实践

### 1. 数据录入
- **定期录入**: 建议每日录入用电数据
- **数据准确**: 确保录入数据的准确性
- **及时处理**: 及时处理系统告警

### 2. 设备管理
- **完整信息**: 录入完整的设备信息
- **状态更新**: 及时更新设备状态
- **维护计划**: 制定合理的维护计划

### 3. 分析优化
- **定期分析**: 每周进行能耗分析
- **关注趋势**: 重点关注能耗变化趋势
- **实施建议**: 积极实施系统建议

### 4. 成本控制
- **预算管理**: 设定合理的电费预算
- **峰谷优化**: 合理安排用电时间
- **效率提升**: 持续提升设备效率

### 5. 数据安全
- **定期备份**: 每周备份系统数据
- **权限控制**: 限制数据访问权限
- **版本管理**: 保留多个备份版本

## 技术支持

如遇到技术问题，请按以下步骤操作：

1. **查阅文档**: 首先查看本使用说明
2. **运行测试**: 执行系统测试脚本
3. **收集信息**: 记录错误信息和操作步骤
4. **联系支持**: 提供详细的问题描述

**联系方式**:
- 技术支持邮箱: support@example.com
- 在线文档: https://docs.example.com
- 社区论坛: https://forum.example.com

---

**智能能耗管理系统** - 专业、可靠、易用的能源管理解决方案！

